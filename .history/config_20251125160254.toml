[llm]
base_url = "http://127.0.0.1:8080/v1"
model    = "numind/NuExtract-2.0-8B"
api_key  = "sk-local"
use_grammar = false
max_tokens = 1024
temperature = 0.0

[pdf]
path = "data/dys064.pdf"
max_pages = 40

# ---------- PASS A: Structuur & Metadata ----------
[task_main]
template_json = """
{
  "pid": "string",
  "study_name": "string",
  "study_acronym": "string",
  "study_types": ["string"],
  "cohort_type": "string",
  "website": "string",
  "start_year": "integer",
  "end_year": "integer",
  "contact_email": "string",
  "n_included": "integer",
  "countries": ["verbatim-string"],
  "regions": ["verbatim-string"],
  "population_age_group": "string"
}
"""

instructions = """
Extract exact values from the text.

- pid: 
  Locate the DOI string (starts with "10."). Return exact ID (e.g. "10.1186/...").

- study_name: Official name of the cohort.
- study_acronym: The acronym used (e.g. "OncoLifeS").
- study_types: Select tags: "Biobank", "Cohort study", "Clinical trial", "Registry".
- cohort_type: Specific type (e.g. "hospital-based cohort").
- website: Main URL.
- contact_email: Contact email address.
- n_included: Number of participants enrolled (e.g. 3704).

- start_year: Year recruitment started.

- end_year: 
  The year recruitment PERMANENTLY ended.
  CRITICAL RULE: If the text mentions "ongoing basis", "continued adherence", or "future research", return null.
  (In this text: "Inclusion... is prospective and on an ongoing basis" -> return null).

- countries:
  Country of recruitment. Use full name (e.g. "Netherlands").

- regions:
  Specific region (e.g. "North of the Netherlands").

- population_age_group:
  The age range of eligible participants (e.g. "â‰¥18 years").
"""

# ---------- PASS B: Criteria & Design (Strict Cleanup) ----------
[task_criteria]
template_json = """
{
  "inclusion_criteria": ["string"],
  "other_inclusion_criteria": ["string"],
  "exclusion_criteria": ["string"],
  "other_exclusion_criteria": ["string"],
  "clinical_study_types": ["string"]
}
"""

instructions = """
Extract eligibility criteria.
STRICT CONSTRAINT: You must STRIP ages and administrative phrases.

- inclusion_criteria:
  List the diseases or participant groups.
  FORBIDDEN: Do NOT include age numbers. Do NOT include "informed consent".
  
  Correct Transformations:
  * "Adult patients (>18 years) diagnosed with cancer" -> "patients with cancer"
  * "patients with genetically increased risk of cancer" -> "patients with genetically increased risk of cancer"
  * "participants of the OncoLifeS" -> (SKIP/REMOVE this generic phrase)

- other_inclusion_criteria:
  List purely administrative requirements EXCEPT informed consent.
  If the only requirement is "Informed consent", return [].
  (We assume consent is always required).

- exclusion_criteria:
  Medical exclusions. If text says "without further exclusion criteria", return [].

- other_exclusion_criteria:
  Non-medical exclusions.

- clinical_study_types:
  Design keywords (e.g. "prospective hospital-based data-biobank").
"""

# ---------- PASS C: Design & Data Collection ----------
[task_design_details]
template_json = """
{
  "design": ["string"],
  "design_description": "string",
  "data_collection_type": ["string"],
  "data_collection_description": "string",
  "description": "string"
}
"""

instructions = """
Extract study design details.

- design:
  Choose from: ["Longitudinal", "Cross-sectional", "Case-control", "Cohort study", "Randomized Controlled Trial"].
  - Longitudinal: Follow-up over time.

- design_description:
  Copy the **single best sentence** defining the study design from the Methods section.
  Example: "We established a hospital-based data-biobank..."

- data_collection_type:
  Choose from: ["Prospective", "Retrospective"].
  - Prospective: Future collection.
  - Retrospective: Past records.

- data_collection_description:
  Copy a sentence describing HOW data was obtained (e.g. "Clinical data are collected by physicians...").

- description:
  Copy the "Aim" or "Objective" sentence verbatim from the Abstract.
"""


[task_population]
template_json = """
{
  "number_of_participants_with_samples": "integer",
  "underlying_population": "string",
  "population_of_interest": ["string"],
  "population_of_interest_other": "string",
  "part_of_networks": ["string"],
  "population_entry": ["string"],
  "population_entry_other": "string",
  "population_exit": ["string"],
  "population_exit_other": "string",
  "population_disease": ["string"],
  "population_oncology_topology": ["string"],
  "population_oncology_morphology": ["string"],
  "population_coverage": "string",
  "population_not_covered": "string",
  "age_min": "integer",
  "age_max": "integer"
}
"""

instructions = """
Extract population and sample details. If a specific value is not mentioned, return null.

- number_of_participants_with_samples:
  Specific number of individuals with **biological samples** (DNA, blood, tissue).
  Look for "DNA on ... children" or "Biobank samples".
  Do NOT use the total recruitment number.

- underlying_population:
  Source population (e.g. "General population", "Hospital patients").

- population_of_interest:
  Target group (e.g. "Pregnant women", "Cancer patients", "Children").

- population_of_interest_other:
  Specifics if "Other". If none, return null.

- part_of_networks:
  Consortia/networks this study belongs to (e.g. "ELSPAC").

- population_entry:
  Triggers for registration (e.g. "Birth", "Diagnosis", "Consent").

- population_entry_other:
  If none, return null. Do NOT output the string "Other".

- population_exit:
  Triggers for de-registration (e.g. "Death", "Withdrawal").

- population_exit_other:
  If none, return null. Do NOT output the string "Other".

- population_disease:
  The focus disease category.
  CRITICAL RULE: If the study covers general health, development, or multiple diverse conditions (like a birth cohort), return ["General Health"]. 
  Only return "Oncology" if the study is specifically about cancer patients.

- population_oncology_topology:
  (Cancer only) Organ/Site. If not a cancer study, return [].

- population_oncology_morphology:
  (Cancer only) Histology. If not a cancer study, return [].

- population_coverage:
  % covered or denominator description.

- population_not_covered:
  Who is missed/excluded?

- age_min:
  Minimum age (integer). "Birth" = 0.

- age_max:
  Maximum age (integer) described in this paper.
"""